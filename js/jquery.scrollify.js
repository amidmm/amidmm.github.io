/*!
 * jQuery Scrollify
 * Version 0.1.11
 *
 * Requires:
 * - jQuery 1.6 or higher
 *
 * https://github.com/lukehaas/Scrollify
 *
 * Copyright 2015, Luke Haas
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
 * the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
 * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
 * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
(function(n,t,i,r){"use strict";function h(i,r){if(l===!0)return!0;c[i]&&(e.before(i,a),v=1,e.sectionName&&(t.location.hash=c[i]),r?(n(e.target).stop().scrollTop(o[i]),e.after(i,a)):(n(e.target).stop().animate({scrollTop:o[i]},e.scrollSpeed,e.easing),n(e.target).promise().done(function(){d=!1;e.after(i,a)})))}function ut(n){var f,e;if(n<4)return!1;var t=20,i=0,r=n.length-1,u;for(n.length<t*2&&(t=Math.floor(n.length/2)),u=n.length-t;r>=u;r--)i=i+n[r];for(f=i/t,i=0,r=n.length-t-1,u=n.length-t*2;r>=u;r--)i=i+n[r];return e=i/t,f>=e?!0:!1}function ft(n,t){for(var i=c.length;i>=0;i--)typeof n=="string"?c[i]===n&&(u=i,h(i,t)):i===n&&(u=i,h(i,t))}var o=[],c=[],a=[],b=[],u=0,v=1,et=t.location.hash,tt=!1,g,it,y=n(t).scrollTop(),k=!1,d=!1,nt=!1,s,f,w,l=!1,p=[],rt=(new Date).getTime(),e={section:"section",sectionName:"section-name",easing:"easeOutExpo",scrollSpeed:1100,offset:0,scrollbars:!0,scrollable:!0,axis:"y",target:"html,body",before:function(){},after:function(){},afterResize:function(){}};n.scrollify=function(r){function et(t){n(e.target).stop().animate({scrollTop:t},e.scrollSpeed,e.easing)}function st(){n(e.section).each(function(i){n(this).css("height","auto").outerHeight()<n(t).height()?(n(this).css({height:n(t).height()}),b[i]=!1):(n(this).css({height:n(this).height()}),b[i]=!0)})}function ht(i){n(e.section).each(function(i){o[i]=i>0?parseInt(n(this).offset().top)+e.offset:parseInt(n(this).offset().top);c[i]=e.sectionName&&n(this).data(e.sectionName)?"#"+n(this).data(e.sectionName).replace(/ /g,"-"):"#"+(i+1);a[i]=n(this);t.location.hash===c[i]&&(u=i,tt=!0)});!0===i&&h(u,!1)}function ot(){return y=n(t).scrollTop(),y>parseInt(o[u])?!1:!0}function ft(){return y=n(t).scrollTop(),y<parseInt(o[u])+(a[u].height()-n(t).height())?!1:!0}n.easing.easeOutExpo=function(n,t,i,r,u){return t==u?i+r:r*(-Math.pow(2,-10*t/u)+1)+i};s={handleMousedown:function(){if(l===!0)return!0;k=!1;nt=!1},handleMouseup:function(){if(l===!0)return!0;k=!0;nt&&s.calculateNearest()},handleScroll:function(){if(l===!0)return!0;g&&clearTimeout(g);g=setTimeout(function(){if(nt=!0,k===!1)return!1;k=!1;s.calculateNearest()},200)},calculateNearest:function(){y=n(t).scrollTop();for(var r=1,l=o.length,f=0,c=Math.abs(o[0]-y),e;r<l;r++)e=Math.abs(o[r]-y),e<c&&(c=e,f=r);ft()?n(i).unbind("DOMMouseScroll mousewheel",s.wheelHandler):n(i).bind("DOMMouseScroll mousewheel",s.wheelHandler);(ft()||ot())&&(u=f,h(f,!1))},wheelHandler:function(n,t){if(l===!0)return!0;b[u]||n.preventDefault();var i=(new Date).getTime();if(t=t||-n.originalEvent.detail/3||n.originalEvent.wheelDelta/120,i-rt>1300&&(p=[]),rt=i,p.length>=35&&p.shift(),p.push(Math.abs(t*10)),d)return!1;if(t<0){if(u<o.length-1&&ft())if(ut(p))n.preventDefault(),u++,d=!0,h(u,!1);else return!1}else if(t>0&&u>0&&ot())if(ut(p))n.preventDefault(),u--,d=!0,h(u,!1);else return!1},keyHandler:function(n){if(l===!0)return!0;n.keyCode==38?u>0&&ot()&&(u--,h(u,!1)):n.keyCode==40&&u<o.length-1&&ft()&&(u++,h(u,!1))},init:function(){e.scrollbars?(n(t).bind("mousedown",s.handleMousedown),n(t).bind("mouseup",s.handleMouseup),n(t).bind("scroll",s.handleScroll)):n("body").css({overflow:"hidden"});n(i).bind("DOMMouseScroll mousewheel",s.wheelHandler);n(i).bind("keydown",s.keyHandler)}};f={touches:{touchstart:{y:-1},touchmove:{y:-1},touchend:!1,direction:"undetermined"},options:{distance:30,timeGap:800,timeStamp:(new Date).getTime()},touchHandler:function(n){if(l===!0)return!0;var t;if(typeof n!="undefined"&&typeof n.touches!="undefined"){t=n.touches[0];switch(n.type){case"touchstart":f.touches.touchstart.y=t.pageY;f.touches.touchmove.y=-1;f.options.timeStamp=(new Date).getTime();f.touches.touchend=!1;case"touchmove":f.touches.touchmove.y=t.pageY;f.touches.touchstart.y!==f.touches.touchmove.y&&(n.preventDefault(),f.options.timeStamp+f.options.timeGap<(new Date).getTime()&&f.touches.touchend==!1&&(f.touches.touchend=!0,f.touches.touchstart.y>-1&&Math.abs(f.touches.touchmove.y-f.touches.touchstart.y)>f.options.distance&&(f.touches.touchstart.y<f.touches.touchmove.y?f.up():f.down())));break;case"touchend":f.touches[n.type]===!1&&(f.touches[n.type]=!0,f.touches.touchstart.y>-1&&f.touches.touchmove.y>-1&&(Math.abs(f.touches.touchmove.y-f.touches.touchstart.y)>f.options.distance&&(f.touches.touchstart.y<f.touches.touchmove.y?f.up():f.down()),f.touches.touchstart.y=-1))}}},down:function(){u<=o.length-1&&(ft()&&u<o.length-1?(u++,h(u,!1)):Math.floor(a[u].height()/n(t).height())>v?(et(parseInt(o[u])+n(t).height()*v),v+=1):et(parseInt(o[u])+(a[u].height()-n(t).height())))},up:function(){u>=0&&(ot()&&u>0?(u--,h(u,!1)):v>2?(v-=1,et(parseInt(o[u])+n(t).height()*v)):(v=1,et(parseInt(o[u]))))},init:function(){i.addEventListener&&(i.addEventListener("touchstart",f.touchHandler,!1),i.addEventListener("touchmove",f.touchHandler,!1),i.addEventListener("touchend",f.touchHandler,!1))}};w={handleResize:function(){clearTimeout(it);it=setTimeout(function(){st();ht(!0);e.afterResize()},50)}};e=n.extend(e,r);st();ht(!1);tt===!1&&e.sectionName?t.location.hash=c[0]:h(u,!1);s.init();f.init();n(t).bind("resize",w.handleResize);t.addEventListener("orientationchange",w.handleResize,!1)};n.scrollify.move=function(n){if(n===r)return!1;ft(n,!1)};n.scrollify.instantMove=function(n){if(n===r)return!1;ft(n,!0)};n.scrollify.next=function(){u<c.length&&(u+=1,h(u,!1))};n.scrollify.previous=function(){u>0&&(u-=1,h(u,!1))};n.scrollify.instantNext=function(){u<c.length&&(u+=1,h(u,!0))};n.scrollify.instantPrevious=function(){u>0&&(u-=1,h(u,!0))};n.scrollify.destroy=function(){n(e.section).each(function(){n(this).css("height","auto")});n(t).unbind("resize",w.handleResize);e.scrollbars&&(n(t).unbind("mousedown",s.handleMousedown),n(t).unbind("mouseup",s.handleMouseup),n(t).unbind("scroll",s.handleScroll));n(i).unbind("DOMMouseScroll mousewheel",s.wheelHandler);n(i).unbind("keydown",s.keyHandler);i.addEventListener&&(i.removeEventListener("touchstart",f.touchHandler,!1),i.removeEventListener("touchmove",f.touchHandler,!1),i.removeEventListener("touchend",f.touchHandler,!1));o=[];c=[];a=[];b=[]};n.scrollify.update=function(){w.handleResize()};n.scrollify.current=function(){return a[u]};n.scrollify.disable=function(){l=!0};n.scrollify.enable=function(){l=!1};n.scrollify.isDisabled=function(){return l}})(jQuery,this,document);